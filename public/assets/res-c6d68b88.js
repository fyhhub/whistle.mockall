import{a as y,o as g,b as v,d as A,n as B,u as k,r as C,e as J,f as T,g as R,h as z,c as H}from"./runtime-dom.esm-bundler-71c8b7b3.js";const L={style:{position:"relative"}},F=["contentEditable","innerHTML"],M={key:0,class:"error-popup",style:{display:"none",position:"absolute",bottom:"6px",right:"24px",color:"#d23b3b","font-size":"12px","font-weight":"600","user-select":"none"}},W={__name:"LiteJsonEditor",props:{modelValue:{type:[String,Object,null],required:!0},indent:{type:Number,default:3},dark:Boolean,formatting:Object,withoutEdit:Boolean,withoutError:Boolean},emits:["update:modelValue"],setup(u,{emit:m}){const o=u,p=y(()=>({number:"#a9dc76",braces:"#84aecc",brackets:"#d26a6a",colon:o.dark?"#ffffff":"#4f4f4f",comma:o.dark?"#ffff25":"#f8c33b",string:o.dark?"#78dce8":"#5f9fca",string_quotes:"#e393ff",key:"#ff6188",key_quotes:"#fc9867",null:"#cccccc",true:o.dark?"#c2e69f":"#8ccf79",false:"#e69fc2"})),r=y(()=>o.formatting?Object.keys(p.value).reduce((e,n)=>{var t;return{...e,[n]:(t=o.formatting[n])!=null?t:p.value[n]}},{}):p.value),E=e=>{const n=document.getSelection();if(n.rangeCount>0){const t=n.getRangeAt(0),a=t.cloneRange();a.selectNodeContents(e),a.setEnd(t.endContainer,t.endOffset);const l=a.toString(),s=l[l.length-1],c=b(l,s);return{character:s,occurrence:c,section:l}}return null},x=(e,n)=>{const t=window.getSelection(),a=document.createRange();let l=w(e),s=n.occurrence,c=0,i;for(let f=0;f<l.length&&(i=l[f],c=_(i.textContent,n.character,s),!(c>=0));f++)s-=b(i.textContent,n.character);c++,a.setStart(i,c),a.setEnd(i,c),t.removeAllRanges(),t.addRange(a)},S=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),_=(e,n,t)=>{const a=e.split(n,t).join(n).length;return a===e.length?-1:a},b=(e,n)=>n?e.replace(new RegExp(`[^${S(n)}]`,"g"),"").length:0,w=e=>{let n,t=[],a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;n=a.nextNode();)t.push(n);return t},N=(e,n=0)=>{if(e===null)return`<span style="color: ${r.value.null}">null</span>`;let t="";return t+=`<span style="color: ${r.value.braces}">{</span>
`,Object.keys(e).forEach((a,l,s)=>t+=`${"&nbsp;".repeat(n+o.indent)}<span style="color: ${r.value.key}"><span style="color: ${r.value.key_quotes}">"</span>${a}<span style="color: ${r.value.key_quotes}">"</span></span><span style="color: ${r.value.colon}">:</span>${d(e[a],n+o.indent)}${l<s.length-1?`<span style="color: ${r.value.comma}">,</span>`:""}
`),t+="&nbsp;".repeat(n),t+=`<span style="color: ${r.value.braces}">}</span>`,t},O=(e,n=0)=>{let t="";return t+=`<span style="color: ${r.value.brackets}">[</span>
`,e.forEach((a,l,s)=>t+=`${"&nbsp;".repeat(n+o.indent)}<span>${d(a,n+o.indent)}</span>${l<s.length-1?`<span style="color: ${r.value.comma}">,</span>`:""}
`),t+="&nbsp;".repeat(n),t+=`<span style="color: ${r.value.brackets}">]</span>`,t},V=e=>`<span style="color: ${r.value.string}"><span style="color: ${r.value.string_quotes}">"</span>${e}<span style="color: ${r.value.string_quotes}">"</span></span>`,j=e=>`<span style="color: ${r.value[e]}">${e}</span>`,q=e=>`<span style="color: ${r.value.number}">${e}</span>`,d=(e,n=0)=>{const t=Array.isArray(e)?"array":typeof e;return $[t]?$[t](e,n):e},$={object:N,array:O,string:V,boolean:j,number:q},h=y({get:()=>o.modelValue?d(typeof o.modelValue=="string"?JSON.parse(o.modelValue):o.modelValue):"",set:async e=>{try{const n=e.innerText.split(/[\xa0\n]+/).join("");let t=n?JSON.parse(n):null,a;if(typeof o.modelValue=="string"?(t=t?JSON.stringify(t):"",a=t!==o.modelValue):a=JSON.stringify(t)!==JSON.stringify(o.modelValue),o.withoutError||(e.nextElementSibling.style.display="none"),a){const l=t&&E(e);m("update:modelValue",t),l&&(await T(),x(e,l))}}catch{o.withoutError||(e.nextElementSibling.style.display="block")}}});return(e,n)=>(g(),v("div",L,[A("div",{style:B([u.dark&&"background: #252530; color: #ffffff","height: 100%; width: 100%; padding: 4px; border-radius: inherit; font-family: monospace; overflow: auto; outline: none; white-space: pre-wrap; box-sizing: border-box"]),contentEditable:!u.withoutEdit,onKeyup:n[0]||(n[0]=t=>h.value=t.target),innerHTML:k(h)},null,44,F),C(e.$slots,"default",{},()=>[u.withoutError?J("",!0):(g(),v("div",M,"Incorrect JSON format"))])]))}},I=R({__name:"App",setup(u){return(m,o)=>(g(),z(k(W)))}});H(I).mount("#app");
