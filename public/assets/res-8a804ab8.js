import{a as h,o as x,b as _,d as J,n as R,u as C,r as D,e as L,f as H,g as Z,h as I,i as M,c as W}from"./runtime-dom.esm-bundler-4968a867.js";const K={style:{position:"relative"}},P=["contentEditable","innerHTML"],X={key:0,class:"error-popup",style:{display:"none",position:"absolute",bottom:"6px",right:"24px",color:"#d23b3b","font-size":"12px","font-weight":"600","user-select":"none"}},G={__name:"LiteJsonEditor",props:{modelValue:{type:[String,Object,null],required:!0},indent:{type:Number,default:3},dark:Boolean,formatting:Object,withoutEdit:Boolean,withoutError:Boolean},emits:["update:modelValue"],setup(e,{emit:a}){const r=e,i=h(()=>({number:"#a9dc76",braces:"#84aecc",brackets:"#d26a6a",colon:r.dark?"#ffffff":"#4f4f4f",comma:r.dark?"#ffff25":"#f8c33b",string:r.dark?"#78dce8":"#5f9fca",string_quotes:"#e393ff",key:"#ff6188",key_quotes:"#fc9867",null:"#cccccc",true:r.dark?"#c2e69f":"#8ccf79",false:"#e69fc2"})),l=h(()=>r.formatting?Object.keys(i.value).reduce((t,n)=>{var o;return{...t,[n]:(o=r.formatting[n])!=null?o:i.value[n]}},{}):i.value),d=t=>{const n=document.getSelection();if(n.rangeCount>0){const o=n.getRangeAt(0),s=o.cloneRange();s.selectNodeContents(t),s.setEnd(o.endContainer,o.endOffset);const c=s.toString(),u=c[c.length-1],p=A(c,u);return{character:u,occurrence:p,section:c}}return null},V=(t,n)=>{const o=window.getSelection(),s=document.createRange();let c=T(t),u=n.occurrence,p=0,y;for(let m=0;m<c.length&&(y=c[m],p=O(y.textContent,n.character,u),!(p>=0));m++)u-=A(y.textContent,n.character);p++,s.setStart(y,p),s.setEnd(y,p),o.removeAllRanges(),o.addRange(s)},N=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),O=(t,n,o)=>{const s=t.split(n,o).join(n).length;return s===t.length?-1:s},A=(t,n)=>n?t.replace(new RegExp(`[^${N(n)}]`,"g"),"").length:0,T=t=>{let n,o=[],s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);for(;n=s.nextNode();)o.push(n);return o},F=(t,n=0)=>{if(t===null)return`<span style="color: ${l.value.null}">null</span>`;let o="";return o+=`<span style="color: ${l.value.braces}">{</span>
`,Object.keys(t).forEach((s,c,u)=>o+=`${"&nbsp;".repeat(n+r.indent)}<span style="color: ${l.value.key}"><span style="color: ${l.value.key_quotes}">"</span>${s}<span style="color: ${l.value.key_quotes}">"</span></span><span style="color: ${l.value.colon}">:</span>${g(t[s],n+r.indent)}${c<u.length-1?`<span style="color: ${l.value.comma}">,</span>`:""}
`),o+="&nbsp;".repeat(n),o+=`<span style="color: ${l.value.braces}">}</span>`,o},j=(t,n=0)=>{let o="";return o+=`<span style="color: ${l.value.brackets}">[</span>
`,t.forEach((s,c,u)=>o+=`${"&nbsp;".repeat(n+r.indent)}<span>${g(s,n+r.indent)}</span>${c<u.length-1?`<span style="color: ${l.value.comma}">,</span>`:""}
`),o+="&nbsp;".repeat(n),o+=`<span style="color: ${l.value.brackets}">]</span>`,o},z=t=>`<span style="color: ${l.value.string}"><span style="color: ${l.value.string_quotes}">"</span>${t}<span style="color: ${l.value.string_quotes}">"</span></span>`,U=t=>`<span style="color: ${l.value[t]}">${t}</span>`,q=t=>`<span style="color: ${l.value.number}">${t}</span>`,g=(t,n=0)=>{const o=Array.isArray(t)?"array":typeof t;return v[o]?v[o](t,n):t},v={object:F,array:j,string:z,boolean:U,number:q},$=h({get:()=>r.modelValue?g(typeof r.modelValue=="string"?JSON.parse(r.modelValue):r.modelValue):"",set:async t=>{try{const n=t.innerText.split(/[\xa0\n]+/).join("");let o=n?JSON.parse(n):null,s;if(typeof r.modelValue=="string"?(o=o?JSON.stringify(o):"",s=o!==r.modelValue):s=JSON.stringify(o)!==JSON.stringify(r.modelValue),r.withoutError||(t.nextElementSibling.style.display="none"),s){const c=o&&d(t);a("update:modelValue",o),c&&(await H(),V(t,c))}}catch{r.withoutError||(t.nextElementSibling.style.display="block")}}});return(t,n)=>(x(),_("div",K,[J("div",{style:R([e.dark&&"background: #252530; color: #ffffff","height: 100%; width: 100%; padding: 4px; border-radius: inherit; font-family: monospace; overflow: auto; outline: none; white-space: pre-wrap; box-sizing: border-box"]),contentEditable:!e.withoutEdit,onKeyup:n[0]||(n[0]=o=>$.value=o.target),innerHTML:C($)},null,44,P),D(t.$slots,"default",{},()=>[e.withoutError?L("",!0):(x(),_("div",X,"Incorrect JSON format"))])]))}},Q=typeof atob=="function",w=typeof Buffer=="function",k=typeof TextDecoder=="function"?new TextDecoder:void 0;typeof TextEncoder=="function"&&new TextEncoder;const Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee=Array.prototype.slice.call(Y),b=(e=>{let a={};return e.forEach((r,i)=>a[r]=i),a})(ee),te=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,f=String.fromCharCode.bind(String),E=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),S=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),oe=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ne=e=>{switch(e.length){case 4:var a=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=a-65536;return f((r>>>10)+55296)+f((r&1023)+56320);case 3:return f((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return f((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},re=e=>e.replace(oe,ne),ae=e=>{if(e=e.replace(/\s+/g,""),!te.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let a,r="",i,l;for(let d=0;d<e.length;)a=b[e.charAt(d++)]<<18|b[e.charAt(d++)]<<12|(i=b[e.charAt(d++)])<<6|(l=b[e.charAt(d++)]),r+=i===64?f(a>>16&255):l===64?f(a>>16&255,a>>8&255):f(a>>16&255,a>>8&255,a&255);return r},B=Q?e=>atob(S(e)):w?e=>Buffer.from(e,"base64").toString("binary"):ae,le=w?e=>E(Buffer.from(e,"base64")):e=>E(B(e).split("").map(a=>a.charCodeAt(0))),se=w?e=>Buffer.from(e,"base64").toString("utf8"):k?e=>k.decode(le(e)):e=>re(B(e)),ce=e=>S(e.replace(/[-_]/g,a=>a=="-"?"+":"/")),ie=e=>se(ce(e)),ue=Z({__name:"App",setup(e){const a=I();return console.log("%c Line:10 🍰 window.whistleBridge","color:#ea7e5c",window.whistleBridge),window.onload=()=>{window.whistleBridge.addSessionCompleteListener(function(r){const i=ie(r.res.base64);a.value=i})},(r,i)=>(x(),M(C(G),{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=l=>a.value=l)},null,8,["modelValue"]))}});W(ue).mount("#app");
